var glassdoorData={};$(document).ready(function(){$("#glassdoor-cname").keydown(function(){$("label").css("color","");$("#glassdoor-cname").attr("label","Enter your company's name");$("#glassdoor-submit-button").text("Submit").attr("onclick","processGlassdoor()")});$("#glassdoor-submit-button").text("Submit");$("#glassdoor-progress").hide()});function initGlassdoor(){$("#glassdoor-dialog")[0].open();resetGlassdoorSubmit()}function resetGlassdoorSubmit(){$("#glassdoor-submit-button").text("Submit").attr("onclick","processGlassdoor()")}function processGlassdoor(){var a=$("#glassdoor-cname").val();if(a.length===0){$("label").css("color","red");$("#glassdoor-cname").attr("label","Enter your company's name")}else{openGlassdoor(a)}}function openGlassdoor(a){$.ajax({type:"GET",url:"http://api.glassdoor.com/api/api.htm",dataType:"jsonp",data:{v:1,format:"json","t.p":76164,"t.k":"cXzYgugsXrC",userip:"24.6.216.224",useragent:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.103 Safari/537.36",action:"employers",q:a},beforeSend:function(){$("#glassdoor-progress").show()},complete:function(){$("#glassdoor-progress").hide()},success:function(c){var b=c.response["employers"][0];if(b===undefined){$("label").css("color","red");$("#glassdoor-cname").attr("label","Glassdoor company not found")}else{$("label").css("color","green");$("#glassdoor-cname").attr("label","Glassdoor company and information found");$("#glassdoor-submit-button").text("Select").attr("onclick","addGlassdoorData()");glassdoorData.name=b.name;glassdoorData.website=b.website;glassdoorData.image=b.squareLogo;$.ajax({type:"POST",url:"/ajax/glassdoor-scraper",dataType:"json",data:{link:glassdoorData.image},success:function(e){glassdoorData.key=e.data},error:function(d,f,g){console.error(g)}})}},error:function(){$("label").css("color","red");$("#glassdoor-cname").attr("label","Error. Please try again later.")}})}function addGlassdoorData(){var c=false;var a=["#company","#company-description"];for(var b=0;b<a.length;b++){if($(a[b]).val().length>0){c=true;break}}if($("#company-image-container").children().length!==0){c=true}if(c){$("#glassdoor-alert-dialog")[0].open();$("#glassdoor-alert-ok").click(function(){clearGlassdoorExisting();_addGlassdoorData();$("#glassdoor-alert-dialog")[0].close()});$("#glassdoor-alert-cancel").click(function(){$("#glassdoor-alert-dialog")[0].close();resetGlassdoor()})}else{_addGlassdoorData()}}function _addGlassdoorData(){$("#company").val(glassdoorData.name);$("#company-description").val(glassdoorData.website);addGlassdoorImage();resetGlassdoor()}function addGlassdoorImage(){console.log(glassdoorData);var a=null;var b=glassdoorData.key;if(glassdoorData.image.length>0){a=$('<img class="recruiting-token-image" id="glassdoor-'+b+'">');$(a).attr("src",glassdoorData.image);a.data("file",null);a.data("name","glassdoor-"+b);a.data("saved",false);a.data("scraped",true);a.data("linkedin",false);createThumbnail(a,"company-image-container")}}function clearGlassdoorExisting(){var e="#company-image-container";var b=".photo-thumbnail";var a=$(b);for(var d=0;d<a.length;d++){var f=$(a[d]).attr("id");var c=f.slice(-10);$.ajax({type:"POST",url:"ajax/glassdoor-scraper",dataType:"json",data:{clear:c},error:function(g,h,i){console.error(i)}})}$(e).children().length>0?$(e).empty():null}function resetGlassdoor(){$("#glassdoor-dialog")[0].close();$("label").css("color","");$("#glassdoor-cname").attr("label","Enter your company's name");$("#glassdoor-cname").val("");$("#glassdoor-progress").hide();resetGlassdoorSubmit()}function cancelGlassdoor(){$("label").css("color","");$("#glassdoor-cname").attr("label","Enter your company's name");$("#glassdoor-cname").val("");$("#glassdoor-progress").hide();resetGlassdoorSubmit();$.ajax({type:"POST",dataType:"json",data:{clear:glassdoorData.key},url:"/ajax/glassdoor-scraper",error:function(c,a,b){console.error(b)}})};